<div class="grid-container">
    <ktd-grid [cols]="cols" [rowHeight]="rowHeight" [layout]="layout" [compactType]="compactType" (layoutUpdated)="onLayoutUpdated($event)">
        <ktd-grid-item *ngFor="let item of layout; trackBy:trackById" [id]="item.id" [transition]="currentTransition" [dragStartThreshold]="dragStartThreshold" [draggable]="!disableDrag" [resizable]="!disableResize">
            <div class="grid-widget">
                <safe-floating-options class="widget-options" [widget]="item" (edit)="onEditWidget($event)" (delete)="onDeleteWidget($event)" (expand)="onExpandWidget($event)" *ngIf="canModify"></safe-floating-options>
                <safe-widget [widget]="item"></safe-widget>
                <button (mousedown)="onDisableDragChange(false)" (mouseup)="onDisableDragChange(true)" class="widget-handle" *ngIf="canModify && !phoneView" mat-icon-button cdkDragHandle>
                        <mat-icon>drag_indicator</mat-icon>
                    </button>
                <button class="widget-expand" mat-icon-button (click)="onExpandWidget(item)" *ngIf="!canModify">
                        <mat-icon>open_in_full</mat-icon>
                    </button>
            </div>
        </ktd-grid-item>
    </ktd-grid>
    <safe-dashboard-menu (add)="addItemToLayout($event)" *ngIf="canModify"></safe-dashboard-menu>
</div>